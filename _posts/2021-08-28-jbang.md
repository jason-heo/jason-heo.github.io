---
layout: post
title: "jbang"
categories: "programming"
---

jbangì„ ì´ìš©í•˜ë©´ Java ì–¸ì–´ë¥¼ ë§ˆì¹˜ shell scriptì¸ ê²ƒì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. `jshell`ì„ ì´ìš©í•´ë„ ë¹„ìŠ·í•œ ê±¸ í•  ìˆ˜ ìˆì§€ë§Œ scriptì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°ì—ëŠ” jbangì´ ë” ì¢‹ì•„ë³´ì¸ë‹¤.

### ì„¤ì¹˜í•˜ê¸°

macì˜ ê²½ìš° `brew`ë¥¼ ì´ìš©í•˜ë©´ ì‰½ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤. ê·¸ ì™¸ í™˜ê²½ì€ [install ë¬¸ì„œ](https://www.jbang.dev/documentation/guide/latest/installation.html)ë¥¼ ì°¸ê³ í•˜ì.

```console
$ brew install jbangdev/tap/jbang
Updating Homebrew...
==> Auto-updated Homebrew!
Updated Homebrew from 6da8630f4 to 7e7bdca67.
Updated 2 taps (homebrew/core and homebrew/cask).
==> New Formulae
vue-cli
==> Updated Formulae
Updated 75 formulae.
==> New Casks
sigmaos
==> Updated Casks
Updated 21 casks.

==> Installing jbang from jbangdev/tap
==> Downloading https://github.com/jbangdev/jbang/releases/download/v0.78.0/jbang-0.
Already downloaded: /Users/user/Library/Caches/Homebrew/downloads/9c213ca1805dffaf132ad48ff2475626ea565798f8c427cf44275b10f930d557--jbang-0.78.0.zip
ğŸº  /usr/local/Cellar/jbang/0.78.0: 7 files, 5.9MB, built in 6 seconds
```

### Hello, Jbang

ì²« ë²ˆì§¸ scriptë¥¼ ë§Œë“¤ì–´ë³´ì.

ì•„ë˜ì˜ ëª…ë ¹ì„ ë³µë¶™í•˜ì—¬ `hello.java`ë¥¼ ë§Œë“¤ì.

```
$ cat <<EOM > hello.java
class hello {
  public static void main(String[] args) {
    System.out.println("Hello, Jbang");
  }
}
EOM
```

ì‹¤í–‰ ë°©ë²• ë° ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```
$ jbang hello.java
Downloading JBang...
Installing JBang...
[jbang] Building jar...
Hello, Jbang
```

"Downloading"ê³¼ "Installing"ì€ `jbang`ì„ ìµœì´ˆ ì‹¤í–‰ ì‹œì—ë§Œ ì¶œë ¥ëœë‹¤. `"Building"`ì€ ì†ŒìŠ¤ ì½”ë“œì— ë³€ê²½ì´ ìˆì„ ë•Œë§ˆë‹¤ ì‹¤í–‰ëœë‹¤.

ë§ˆì§€ë§‰ lineì„ ë³´ë©´ ì•Œê² ì§€ë§Œ `"Hello, Jbang"` ì˜ ì¶œë ¥ë˜ì—ˆë‹¤.

JVM ê¸°ë°˜ì´ë¯€ë¡œ ì‹¤í–‰ì´ ì•½ê°„ êµ¼ëœ¬ ê²ƒì€ ì–´ì©” ìˆ˜ ì—†ë‹¤. ê·¸ë¦¬ê³  `javac` í›„ì— `java`ë¡œ ì‹¤í–‰í•˜ëŠ” ê²ƒë³´ë‹¤ë„ ë” ëŠë¦¬ë‹¤.

ë³¸ì¸ í™˜ê²½ì—ì„œëŠ” ìœ„ì˜ ê°„ë‹¨í•œ ì‹¤í–‰ì„ í•˜ëŠ”ë°ë„ 1.4ì´ˆê°€ ì†Œìš”ëœë‹¤.

```
$ time jbang hello.java
Hello, Jbang

real    0m1.426s
user    0m1.495s
sys    0m0.240s
```

### ì‹¤í–‰ íŒŒì¼ ë§Œë“¤ê¸°

ë§¤ë²ˆ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ `jbang hello.java` ì…ë ¥í•˜ê¸° ë²ˆê±°ë¡œìš¸ ê²ƒì´ë‹¤. ì¼ë°˜ ìŠ¤í¬ë¦½íŠ¸ì²˜ëŸ¼ `./hello.java`ë§Œ ì…ë ¥í•´ë„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì–´ë³´ì.

`hello.java` ì œì¼ ìœ„ ì¤„ì„ ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ë©´ ëœë‹¤.

```java
///usr/bin/env jbang "$0" "$@" ; exit $?

class hello {
  public static void main(String[] args) {
    System.out.println("Hello, Jbang");
  }
}
```

ì‹¤í–‰ ë°©ë²• ë° ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```console
$ ./hello.java
Hello, Jbang
```

bashì— `///usr/bin/env jbang "$0" "$@" ; exit $?` ì™€ ê°™ì€ í‘œí˜„ì´ ìˆëŠ”ì§€ ëª¨ë¥´ê³  ìˆì—ˆë‹¤.

ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ê¶ê¸ˆí•˜ì—¬ ê²€ìƒ‰í•´ë³´ë‹ˆ Stackexchangeì— [ê´€ë ¨ëœ ê¸€](https://unix.stackexchange.com/a/162535/52744)ì´ ìˆì—ˆë‹¤.

shellì—ì„œ ì²« lineì´ `//`ë¡œ ì‹œì‘í•˜ëŠ” í•˜ëŠ” ê²½ìš° ê·¸ ë’¤ì— ë‚˜ì˜¤ëŠ” ë¬¸ìë“¤ì„ ì‹¤í–‰í•˜ê³ , ì´í›„ ë‚´ìš©ì€ ë¬´ì‹œí•˜ë¼ëŠ” ê²ƒì„ ì˜ë¯¸í–ˆë‹¤. (í˜¸í™˜ì„±ì„ ìœ„í•´ì„œ `///` ì²˜ëŸ¼ slash 3ê°œë¥¼ ì‚¬ìš©í•˜ë¼ê³  í•˜ëŠ”ë° ì •í™•í•œ ì˜ë¯¸ëŠ” ëª¨ë¥´ê² ë‹¤)

ë”°ë¼ì„œ `./hello.java`ë¼ê³  ì‹¤í–‰ì„ í•˜ëŠ” ê²½ìš° ì‹¤ì œ ì‹¤í–‰ë˜ëŠ” ëª…ë ¹ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```
$ /usr/bin/env jbang ./hello.java; exit $?
```

ì°¸ê³ ë¡œ `$0`ëŠ” ì‰˜ì— ì…ë ¥í•œ ëª…ë ¹ì„ ì˜ë¯¸í•˜ê³  `$@`ëŠ” argument ì „ì²´ë¥¼ ì˜ë¯¸í•˜ê³  `$?`ëŠ” ì•ì„œ ì‹¤í–‰í•œ ëª…ë ¹ì˜ exit codeë¥¼ ì˜ë¯¸í•œë‹¤.

### maven ì˜ì¡´ì„± ì¶”ê°€í•˜ê¸°

`jshell` ëŒ€ë¹„ `jbang`ì˜ ê°•ë ¥í•œ ê¸°ëŠ¥ì´ë‹¤. maven ì˜ì¡´ì„±ì„ ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

ì•„ë˜ì˜ í”„ë¡œê·¸ë¨ì€ j-text-utilsë¥¼ ì´ìš©í•œ cli í”„ë¡œê·¸ë¨ì´ë‹¤.

j-text-utils ê´€ë ¨ëœ ì½”ë“œëŠ” [ì´ ë¬¸ì„œ](https://code.google.com/archive/p/j-text-utils/wikis/UsingTextTable.wiki)ì— ìˆëŠ” ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í–ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì´ `print-peole.java`ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì

```java
///usr/bin/env jbang "$0" "$@" ; exit $?
//DEPS com.massisframework:j-text-utils:0.3.4

import dnl.utils.text.table.TextTable;

class Printer {
  public static void main(String[] args) {
    String[] columnNames = {
        "First Name",
        "Last Name",
        "Sport",
        "# of Years",
        "Vegetarian"
    };

    Object[][] data = {
        {"Kathy", "Smith", "Snowboarding", new Integer(5), new Boolean(false)},
        {"John", "Doe", "Rowing", new Integer(3), new Boolean(true)},
        {"Sue", "Black", "Knitting", new Integer(2), new Boolean(false)},
        {"Jane", "White", "Speed reading", new Integer(20), new Boolean(true)},
        {"Joe", "Brown", "Pool", new Integer(10), new Boolean(false)}
    };

    TextTable tt = new TextTable(columnNames, data);

    // this adds the numbering on the left
    tt.setAddRowNumbering(true);

    // sort by the first column
    tt.setSort(0);
    tt.printTable();
  }
}
```

ë‘ ë²ˆì§¸ lineì— ìˆëŠ” `//DEPS com.massisframework:j-text-utils:0.3.4`ê°€ ì˜ì¡´ì„±ì„ ì¶”ê°€í•œ ê²ƒì´ë‹¤.

ì‹¤í–‰ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```console
$ ./print-person.java
[jbang] Resolving dependencies...
[jbang]     Resolving com.massisframework:j-text-utils:0.3.4...Done
[jbang] Dependencies resolved
[jbang] Building jar...

   ______________________________________________________________
   | First Name| Last Name| Sport        | # of Years| Vegetarian|
   |=============================================================|
1. | Jane      | White    | Speed reading| 20        | true      |
2. | Joe       | Brown    | Pool         | 10        | false     |
3. | John      | Doe      | Rowing       | 3         | true      |
4. | Kathy     | Smith    | Snowboarding | 5         | false     |
5. | Sue       | Black    | Knitting     | 2         | false     |
```

`"Resolving dependencies..."`ê°€ ì¶œë ¥ë˜ë©´ì„œ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.

### template

template ê¸°ë°˜ìœ¼ë¡œ java fileì„ ìƒì„±í•  ìˆ˜ë„ ìˆë‹¤.

ì´ì— ê´€í•œ ë„ì›€ë§ì€ [templates](https://www.jbang.dev/documentation/guide/latest/templates.html)ë¬¸ì„œì—ì„œ ë³¼ ìˆ˜ ìˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ cli í”„ë¡œê·¸ë¨ì„ ê°œë°œí•œë‹¤ê³  í•  ë•Œ ë‹¤ìŒì˜ ëª…ë ¹ì„ ì…ë ¥í•˜ë©´ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

template ëª…ë ¹ ì‹¤í–‰

```console
$ jbang init --template=cli helloworld.java
```

`helloworld.java` ë‚´ìš©

```java
///usr/bin/env jbang "$0" "$@" ; exit $?
//DEPS info.picocli:picocli:4.5.0

import picocli.CommandLine;
import picocli.CommandLine.Command;
import picocli.CommandLine.Parameters;

import java.util.concurrent.Callable;

@Command(name = "helloworld", mixinStandardHelpOptions = true, version = "helloworld 0.1",
        description = "helloworld made with jbang")
class helloworld implements Callable<Integer> {

    @Parameters(index = "0", description = "The greeting to print", defaultValue = "World!")
    private String greeting;

    public static void main(String... args) {
        int exitCode = new CommandLine(new helloworld()).execute(args);
        System.exit(exitCode);
    }

    @Override
    public Integer call() throws Exception { // your business logic goes here...
        System.out.println("Hello " + greeting);
        return 0;
    }
}
```

ì‚¬ìš© ê°€ëŠ¥í•œ templateì€ ë‹¤ìŒê³¼ ê°™ì´ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

```console
$ jbang template list
agent = Agent template
cli = CLI template
hello = Basic Hello World template
hello.kt = Basic kotlin Hello World template
qcli = Quarkus CLI template
qmetrics = Quarkus Metrics template
qrest = Quarkus REST template
```

ì•„ì§ ê°œìˆ˜ëŠ” ë§ì§€ ì•Šë‹¤.

ë˜í•œ ìê¸° ìì‹ ì˜ templateë„ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. ë³¸ì¸ì€ í…ŒìŠ¤íŠ¸í•´ë³´ì§€ ì•Šì•˜ë‹¤.
